/*!
 * maptalks.marker.animateto v0.1.0-beta.2
 * LICENSE : MIT
 * (c) 2016-2021 maptalks.org
 */
/*!
 * requires maptalks@>=0.47.0 <1.0.0 
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(require("maptalks")):"function"==typeof define&&define.amd?define(["maptalks"],n):n(e.maptalks)}(this,function(o){"use strict";var n=o.INTERNAL_LAYER_PREFIX+"_marker_animateto",i={speed:1.2,easing:"out",pathSymbol:{lineColor:"#97999b",lineOpacity:.3,lineDasharray:[15,5]}};o.Marker.include({animateTo:function(e,n){var t=this;r(this),n=Object.assign({},i,n);var a=s(e,n,this);return a&&(this.fire("animatetostart"),a.on("shapechange",function(){t.setCoordinates(a.getLastCoordinate())}),this._animateToLine=a),this}});var r=function(e){e._animateToLine&&(e.fire("animatetocancel"),e._animateToLine.remove())},s=function(e,n,t){var a=t.getMap();if(a){var i=t.getCoordinates(),e=u(e,i);if(e){i=c(a),a={visible:!1,symbol:f(n)},i=new o.LineString(e,a).addTo(i);return i.on("remove",function(){t.fire("animatetoend")}),m(i,n),i}}},u=function(e,n){return e instanceof o.Coordinate?[n,e]:Array.isArray(e)?e[0]instanceof o.Coordinate?[n].concat(e):"number"==typeof e[0]?[n,new o.Coordinate(e)]:"number"==typeof e[0][0]?(e=e.map(function(e){return new o.Coordinate(e)}),[n].concat(e)):void 0:void 0},c=function(e){return e.getLayer(n)||new o.VectorLayer(n).addTo(e)},f=function(e){var n=Object.assign({},e.pathSymbol);return e.showPath||(n.lineOpacity=0),n},m=function(n,e){var t=a(n,e),e=e.easing;n.animateShow({duration:t,easing:e},function(e){"finished"===e.state.playState&&n.remove()})},a=function(e,n){var t=e.getLength(),e=(e=n.duration)||t/n.speed*1e3;return e=n.maxDuration?Math.min(e,n.maxDuration):e};"undefined"!=typeof console&&console.log("maptalks.marker.animateto v0.1.0-beta.2, requires maptalks@>=0.47.0 <1.0.0.")});